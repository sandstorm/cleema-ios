Small bug fixes and improvements 
